# recommend_posts_KC
Рекомендательная система постов для пользователей на основе их характеристик и информации об их действиях с ранее опубликованными постами. 

Данные - пользователи, посты и действия пользователей (лайк/просмотр) с этими постами за некоторый промежуток времени.

Реализован GET endpoint, который по id пользователя и заданному времени входа подгружает информацию о пользователе из базы и возвращает группу, к которой относится пользователь: тестовая или контрольная, а также топ 5 постов, рекомендованных моделью по вероятности лайка от этого пользователя. 

В зависимости от группы пользователя прогноз для него строит логистическая регрессия для контрольной группы или catboost для тестовой. Каждая из моделей прогнозирует вероятность лайка заданного пользователя в заданный момент времени для каждого существующего на заданный момент поста. После чего посты ранжируются по вероятности лайка и топ 5 выдаётся пользователю. 

Для моделей генерируются фичи на основе информации о пользователе. Например, города проживания делятся на три тайера по размеру, для них создаются дамми, за базу берётся проживание в Москве. Похожим образом экспертно обрабатываются страны проживания и возраст пользователей. Из дат извлекаются некоторые часы и дни недели. Опытным путём установлено, что экспертная генерация фичей на этих колонках обыгрывает подкапотные методы catboost :)

Тестовая модель дополнена характеристиками, сгенерированными на основе текстов постов с помощью методов глубокого обучения. В частности, тексты неинтерпретируемо побиты на кластеры, и номера этих кластеров добавлены в модель.  

Обмен данными с базой данных настроен с помощью библиотеки SQLAlchemy. Заданы схемы таблиц, задан формат, в котором эндпоинт возвращает записи. Таблицы с фичами пользователей и постов создавались предварительно, эндпоинт генерирует только фичи, зависящие от подаваемого в него времени обращения, остальную информацию он забирает из уже созданных таблиц.

Учебный проект, собранный при прохождении курса StartML от KarpovCourses.
